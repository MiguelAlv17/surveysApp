import{u as w}from"./getDataUsuarios-ec8514d1.js";import{u as U,i as M,s as _,r as q,o as S,c as m,d as b,f as i,w as c,e as t,m as g,l as P}from"./index-cdc5c833.js";import{C as j,c as y,b as R,a as V}from"./alerts-7dbfee83.js";import{M as I}from"./ModernButton-8b041619.js";import{M as u}from"./ModernInput-32844397.js";import{L as F}from"./LoaderBtn-cd6be9a3.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";const A={class:"form-container"},N={class:"footer-content"},z={class:"footer-actions"},D={class:"action-buttons"},G={key:1,class:"material-icons"},O={__name:"Profile",setup(T){const{logout:L}=U(),{addUser:k}=w();M();const o=_({usuario:"",correo:"",tipo_usuario:"",contrasena_v:"",contrasena:""}),n=q(!1),a=_({usuario:"",correo:"",tipo_usuario:"",contrasena_v:"",contrasena:""});S(()=>{f()});const f=()=>{o.correo=localStorage.getItem("email");const s=localStorage.getItem("userRole");o.tipo_usuario=s==1?"Administrador":"Monitoreo"},l=(s,e)=>{switch(s){case"correo":const r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e.trim()?r.test(e)?(a.correo="",!0):(a.correo="Ingrese un correo válido",!1):(a.correo="El correo es requerido",!1);case"contrasena":return e?e.length<6?(a.contrasena="La contraseña debe tener al menos 6 caracteres",!1):(a.contrasena="",!0):(a.contrasena="La contraseña es requerida",!1);case"contrasena_v":return e?e.length<6?(a.contrasena_v="La contraseña de comprobacion debe tener al menos 6 caracteres",!1):(a.contrasena_v="",!0):(a.contrasena_v="La contraseña de comprobacion es requerida",!1);default:return!0}},x=()=>[l("correo",o.correo),l("contrasena",o.contrasena),l("contrasena_v",o.contrasena_v)].every(Boolean),B=()=>{if(o.contrasena==o.contrasena_v)return!0;a.contrasena="Las contraseñas no coinciden",a.contrasena_v="Las contraseñas no coinciden"},C=async()=>{if(!x()){y("Por favor, corrija los errores en el formulario");return}if(!B()){y("Por favor, corrija los errores en el formulario");return}n.value=!0;try{o.usuario=o.correo;const s={usuario:o.usuario,contrasena:o.contrasena,correo:o.usuario,usuarioId:localStorage.getItem("userid")},e=await k(s),{data:r,status:v}=e;v===200||v===201?(await R("Actualizacion exitosa","Redirigiendo a pantalla <strong>Login</strong>",3),L(),p()):V("Error durante el registro")}catch(s){console.error("Error:",s),V("Error durante el registro")}finally{n.value=!1}},p=()=>{Object.keys(o).forEach(s=>{o[s]=""}),Object.keys(a).forEach(s=>{a[s]=""}),f()},E=()=>{p()},d=(s,e)=>{o[s]=e,a[s]&&l(s,e)};return(s,e)=>(m(),b("div",null,[i(j,{title:"Editar perfil",subtitle:"Formulario para editar mi informacion",icon:"account_circle"},{body:c(()=>[t("div",A,[i(u,{modelValue:o.correo,"onUpdate:modelValue":e[0]||(e[0]=r=>o.correo=r),type:"email",label:"Correo Electrónico",onInput:e[1]||(e[1]=r=>d("correo",r.target.value)),onBlur:e[2]||(e[2]=r=>l("correo",o.correo)),icon:"email",placeholder:"ejemplo@correo.com",required:!0,error:a.correo,disabled:n.value},null,8,["modelValue","error","disabled"]),i(u,{modelValue:o.contrasena,"onUpdate:modelValue":e[3]||(e[3]=r=>o.contrasena=r),type:"password",label:"Contraseña",icon:"lock",placeholder:"Mínimo 6 caracteres",required:!0,onInput:e[4]||(e[4]=r=>d("contrasena",r.target.value)),onBlur:e[5]||(e[5]=r=>l("contrasena",o.contrasena)),error:a.contrasena,disabled:n.value},null,8,["modelValue","error","disabled"]),i(u,{modelValue:o.contrasena_v,"onUpdate:modelValue":e[6]||(e[6]=r=>o.contrasena_v=r),type:"password",label:"Contraseña verificacion",icon:"lock",placeholder:"Mínimo 6 caracteres",required:!0,onInput:e[7]||(e[7]=r=>d("contrasena_v",r.target.value)),onBlur:e[8]||(e[8]=r=>l("contrasena_v",o.contrasena_v)),error:a.contrasena_v,disabled:n.value},null,8,["modelValue","error","disabled"]),i(u,{modelValue:o.tipo_usuario,"onUpdate:modelValue":e[9]||(e[9]=r=>o.tipo_usuario=r),type:"text",label:"Rol de usuario",icon:"person",disabled:!0},null,8,["modelValue"]),e[10]||(e[10]=t("div",{class:"form-info mt-3"},[t("div",{class:"info-item"},[t("span",{class:"material-icons"},"info"),t("span",null,"Los campos marcados con * son obligatorios")]),t("div",{class:"info-item"},[t("span",{class:"material-icons"},"security"),t("span",null,"La contraseña debe tener al menos 6 caracteres")])],-1))])]),footer:c(()=>[t("div",N,[e[13]||(e[13]=t("div",{class:"footer-info"},[t("span",{class:"material-icons"},"info"),t("span",null,"Complete todos los campos requeridos")],-1)),t("div",z,[t("div",D,[i(I,{color:"lile",function:E,tooltip:"Cancelar y volver",disabled:n.value},{default:c(()=>e[11]||(e[11]=[t("span",{class:"material-icons"},"arrow_back",-1),g(" Cancelar ",-1)])),_:1,__:[11]},8,["disabled"]),i(I,{color:"purple",function:C,disabled:n.value,tooltip:"Actualizar informacion"},{default:c(()=>[n.value?(m(),P(F,{key:0})):(m(),b("span",G,"save")),e[12]||(e[12]=g(" Guardar Usuario ",-1))]),_:1,__:[12]},8,["disabled"])])])])]),_:1})]))}},Z=$(O,[["__scopeId","data-v-96b886b7"]]);export{Z as default};
